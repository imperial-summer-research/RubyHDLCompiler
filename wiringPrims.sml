(**************************************************************************)
(**************************************************************************)
(***                                                                    ***)
(***    Implementation of built-in wiring primitives:                   ***)
(***                                                                    ***)
(**************************************************************************)
(**************************************************************************)

structure WiringPrims :
  sig
        val append      : (int * int) -> Values.value
  end =
struct

(**************************************************************************)
(**************************************************************************)
(*                                             each wire has 2 loose ends *)
(*                                                           |            *)
(*                                                           V            *)

fun append (m, n) = Values.CIRCUIT (fn () => let  val xs = Exprs.polyList 2 m
                                           val ys = Exprs.polyList 2 n
                                      in   (Exprs.list [Exprs.list xs, Exprs.list ys],
                                            Exprs.list (xs@ys),
                                            [])
                                      end
                            )

(**************************************************************************)
(**************************************************************************)

end (* of structure WiringPrims *);
(* open WiringPrims *)
